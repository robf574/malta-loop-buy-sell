import{j as e}from"./ui-vendor-KGc3Tmx2.js";import{r as i}from"./react-vendor-FMUcr-E9.js";import{g as b,s as o,A,S as L,I as E,B as l,C as d,d as h,a as I,b as H,c as R}from"./index-CyEITM6U.js";import{S as T,a as k,b as B,c as F,d as a}from"./select-ClqPj7ou.js";import{u as _}from"./router-vendor-jMJ2wIS-.js";import{h as z,b as D,i as M,j as q,G}from"./icons-vendor-eQvKQs58.js";import"./supabase-vendor-5tOxYv8x.js";import"./utils-vendor-rD1T8BKC.js";import"./query-vendor-BIjNb4qi.js";function X(){const m=_(),{toast:n}=b(),[j,p]=i.useState([]),[f,g]=i.useState(!0),[r,v]=i.useState(""),[c,S]=i.useState("all"),[C,x]=i.useState(!1);i.useEffect(()=>{o.auth.getSession().then(({data:{session:s}})=>{s||m("/auth")}),y()},[m]);const y=async()=>{try{const{data:s,error:t}=await o.from("services").select("*").eq("status","Active").order("created_at",{ascending:!1});if(t)throw t;p(s||[])}catch(s){console.error("Error fetching services:",s),n({title:"Error",description:"Failed to load services",variant:"destructive"})}finally{g(!1)}},N=async()=>{x(!0);try{const{data:s,error:t}=await o.functions.invoke("recommend-services",{body:{query:r}});if(t)throw t;n({title:"AI Recommendations",description:s.recommendation})}catch(s){console.error("Error getting AI recommendations:",s),n({title:"Error",description:"Failed to get AI recommendations",variant:"destructive"})}finally{x(!1)}},u=j.filter(s=>{const t=r===""||s.title.toLowerCase().includes(r.toLowerCase())||s.description.toLowerCase().includes(r.toLowerCase()),w=c==="all"||s.category===c;return t&&w});return e.jsx(A,{children:e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsx(L,{title:"Services in Malta",subtitle:"Find trusted local services"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(E,{placeholder:"Search services...",value:r,onChange:s=>v(s.target.value),className:"w-full"})}),e.jsxs(l,{onClick:N,disabled:C||!r,variant:"outline",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"AI Help"]})]}),e.jsxs(T,{value:c,onValueChange:S,children:[e.jsx(k,{children:e.jsx(B,{placeholder:"Filter by category"})}),e.jsxs(F,{children:[e.jsx(a,{value:"all",children:"All Categories"}),e.jsx(a,{value:"Tailoring",children:"Tailoring"}),e.jsx(a,{value:"Cobbler",children:"Cobbler"}),e.jsx(a,{value:"Alterations",children:"Alterations"}),e.jsx(a,{value:"Dry Cleaning",children:"Dry Cleaning"}),e.jsx(a,{value:"Repairs",children:"Repairs"}),e.jsx(a,{value:"Home Services",children:"Home Services"}),e.jsx(a,{value:"Beauty Services",children:"Beauty Services"}),e.jsx(a,{value:"Other",children:"Other"})]})]}),e.jsx("div",{className:"grid gap-4",children:f?e.jsx(d,{children:e.jsx(h,{className:"p-6",children:e.jsx("p",{className:"text-center text-muted-foreground",children:"Loading services..."})})}):u.length===0?e.jsx(d,{children:e.jsx(h,{className:"p-6",children:e.jsx("p",{className:"text-center text-muted-foreground",children:"No services found"})})}):u.map(s=>e.jsxs(d,{className:"hover:shadow-md transition-shadow",children:[e.jsx(I,{children:e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{children:[e.jsx(H,{children:s.title}),e.jsx(R,{className:"mt-1",children:s.category})]})})}),e.jsxs(h,{className:"space-y-3",children:[e.jsx("p",{className:"text-sm",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(D,{className:"h-4 w-4"}),s.locality]}),s.pricing_info&&e.jsxs("p",{className:"text-sm font-medium",children:["ðŸ’¶ ",s.pricing_info]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[s.phone&&e.jsx(l,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:`tel:${s.phone}`,children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Call"]})}),s.email&&e.jsx(l,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:`mailto:${s.email}`,children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Email"]})}),s.website&&e.jsx(l,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Website"]})})]})]})]},s.id))})]})})}export{X as default};
